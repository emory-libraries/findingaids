{# list recently modified source EAD files #}

<h2>Recently modified files</h2>

{% if error %}<p class="error">Error: {{ error }}</p>{% endif %}

<div class="pagination">Pages: 
{% for page in show_pages %}
    {% if forloop.first and page != 1%}<a href="?page=1">1</a> ... {% endif %}
    {% ifequal page files.number %} {{ page }}
    {% else %}<a href='?page={{ page }}'>{{ page }}</a>
    {% endifequal %}    
    {%if forloop.last and page != files.paginator.num_pages %} ...  {% endif %}
{% endfor %}
{% if files.paginator.num_pages not in show_pages %}
  <a href='?page={{ files.paginator.num_pages }}'>{{ files.paginator.num_pages }}</a>
{% endif %}
</div>

<table>
    <tr>
        <th colspan="4">Filename</th> {# spans columns for publish, preview, & clean #}
        <th>Last Modified</th>
    </tr>
{% for file, mtime in files.object_list %}
    <tr>
        <td>{{ file }}</td>
        <td>
            <form action="{% url fa-admin:publish-ead %}" method="post">{% csrf_token %}
                <button type="submit" name="filename" value="{{ file }}" >PUBLISH</button>
            </form>
        </td>
        <td>
            <form action="{% url fa-admin:preview-ead %}" method="post">{% csrf_token %}
                <button type="submit" name="filename" value="{{ file }}" >PREVIEW</button>
            </form>
        </td>
        <td><a href="{% url fa-admin:cleaned-ead-about file %}">CLEAN</a></td>
        <td>{{ mtime|date}} ({{ mtime|timesince }} ago)</td>
    </tr>
{% empty %}
  <tr><td colspan="2">No files found</td></tr>
{% endfor %}
</table>
</form>